// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum ProjectHandle {
  Organization
  User
}

enum AuditLogTarget {
  Organization
  Project
}

enum AuditLogAction {
  ADDED_MEMBER
  REMOVED_MEMBER
  UPDATED_MEMBER
  PROJECT_WENT_PRIVATE
  PROJECT_WENT_PUBLIC
  ADDED_WEBHOOK
  REMOVED_WEBHOOK
  UPDATED_WEBHOOK
  MEMBER_ADDED_TO_ORG
  MEMBER_REMOVED_FROM_ORG
  MEMBER_UPDATED_PERMISSIONS
}

enum ContributionState {
  OPENED
  NEEDS_REVIEW
  CLOSED
  MERGED
}

model User {
  twitterHandle String?
  description   String?
  updatedAt     DateTime       @updatedAt
  createdAt     DateTime
  password      String
  username      String
  avatar        String?
  email         String
  flags         Int
  name          String?
  id            String         @id
}

model AccessTokens {
  user_id String
  token   String
  id      String @id
}

model Project {
  contributors String[]
  updatedAt    DateTime @updatedAt
  createdAt    DateTime
  directory    String
  ownerID      String
  webhooks     Webhook[]
  handle       ProjectHandle
  flags        Int
  id           String @id
}

model Webhook {
  successfulHits Int
  contentType    String
  failedHits     Int
  projectId      String
  project        Project @relation(fields: [projectId], references: [id])
  auth           String?
  id             String @id
}

model AuditLogs {
  actionType    AuditLogAction
  project       String
  reason        String?
  target        AuditLogTarget

  // Audit Logs can have specific data tied to it's target.
  data          Json?
  id            String @id
}
